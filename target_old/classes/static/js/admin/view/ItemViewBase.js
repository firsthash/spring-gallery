define(["backbone"],function(a){return a.View.extend({baseEvents:{"change >input[type=file]":"onFileChange","change >input[type=text], >textarea":"onTextChange",},baseInitialize:function(b){if(!this.events){this.events={}}_.extend(this.events,this.baseEvents);if(b.hide){this.hide=b.hide}},hide:"content-title url style",hideFields:function(){var b=this.hide.split(/\s+/);_.each(b,function(c){this.$("[data-name={}]".format(c)).addClass("hidden")},this)},filterPos:function(c,b){if(c>b){return ++c}if(c<b){return --c}return c},onTextChange:function(f){console.log("onTextChange called");var c=$(f.target);var b=c.data("name").replace(this.prefix,"");var d=c.val();if(typeof d!="undefined"){if(b=="position"){d=this.filterPos(d,this.model.get(b))}this.model.set(b,d)}},onFileChange:function(d){console.log("doUpload");var c=new FormData();var b=d.target.files[0];c.append("upload",b);$.ajax({url:"/menuitemupload",type:"POST",data:c,success:function(e){this.$(">input[data-name=content-url]").val(e).trigger("change")},error:function(f,e){console.log("upload error");console.log(e)},cache:false,contentType:false,processData:false,context:this,});console.log("doUpload")},})});